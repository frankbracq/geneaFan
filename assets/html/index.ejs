<!DOCTYPE html>
<html lang="${locale}">

<head>
    <meta charset="UTF-8">
    <title>Geneafan</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Arbreomatic description">
    <meta name="author" content="Genealog.ie">
    <meta name="robots" content="noindex, follow">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
</head>

<body>
    <header>
        <!-- Header avec les tabs et navbar restructuré en deux lignes -->
        <div class="fixed-top" id="tab-header">
            <nav class="navbar navbar-expand custom-navbar">
                <!-- Première ligne: sections gauche et droite -->
                <div class="container-fluid w-100">


                    <!-- Section gauche avec les onglets qui devient un dropdown sur mobile -->
                    <div class="navbar-nav d-flex flex-row" role="tablist" id="left-container">
                        <!-- Gardez seulement les onglets normaux, le JS s'occupera de créer le dropdown -->
                        <ul class="nav nav-pills d-flex" id="tab-nav">
                            <li class="nav-item">
                                <a class="nav-link active" href="#tab1" data-bs-toggle="tab" data-tab-name="Fan">
                                    <span class="tab-label" id="tab1-label" data-bs-toggle="tooltip" data-bs-placement="bottom"
                                        title="Éventail des ancêtres">Éventail</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link disabled" href="#tab2" data-bs-toggle="tab" data-tab-name="Map">
                                    <span class="tab-label" id="tab2-label" data-bs-toggle="tooltip" data-bs-placement="bottom"
                                        title="Carte des lieux familiaux">Carte</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link disabled" href="#tab3" data-bs-toggle="tab" data-tab-name="Tree">
                                    <span class="tab-label" id="tab3-label" data-bs-toggle="tooltip" data-bs-placement="bottom"
                                        title="Arbre généalogique familial">Arbre</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link disabled" href="#tab4" data-bs-toggle="tab" data-tab-name="Timeline">
                                    <span class="tab-label" id="tab4-label" data-bs-toggle="tooltip" data-bs-placement="bottom"
                                        title="Frise chronologique des événements familiaux">Événements</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link disabled" href="#tab5" data-bs-toggle="tab" data-tab-name="Stats">
                                    <span class="tab-label" id="tab5-label" data-bs-toggle="tooltip" data-bs-placement="bottom"
                                        title="Statistiques">Stats</span>
                                </a>
                            </li>
                        </ul>
                    </div>

                    <!-- Section droite avec les contrôles -->
                    <div class="navbar-nav ms-auto d-flex flex-row" id="right-container">
                        <!-- File dropdown -->
                        <div class="dropdown me-3">
                            <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="fileMenu"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bi bi-file-earmark"></i> Fichier
                            </button>
                            <ul class="dropdown-menu" aria-labelledby="fileMenu">
                                <li class="dropdown-header">Import GEDCOM</li>
                                <li>
                                    <a class="dropdown-item" href="#">
                                        <div class="input-file-container text-center" style="cursor: pointer;"
                                            id="gedcomFileInput">
                                            <%= __('geneafan.your_gedcom_file') %>
                                                <input type="file" name="file" id="file" accept=".ged,.gedcom"
                                                    style="cursor: pointer;">
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item protected-feature" data-action="fetchGedcomFiles" href="#"
                                        id="myGedcomFiles">
                                        <%= __('geneafan.my_gedcom_files') %>
                                            <sup>
                                                <span
                                                    style="display: inline-block; width: 14px; height: 14px; border-radius: 50%; border: 1px solid #777; text-align: center; line-height: 12px; font-size: 10px; cursor: help;"
                                                    data-bs-toggle="tooltip" data-bs-placement="bottom"
                                                    title="Accéder à vos fichiers Gedcom sauvegardés">?</span>
                                            </sup>
                                    </a>
                                </li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li>
                                    <a class="dropdown-item remote-file" href="#"
                                        data-link="https://files.genealog.ie/Arbre_Robin_Keller_7G_25-10-2023.ged"
                                        id="gedcomFileSample">
                                        <%= __('geneafan.or_try_sample') %>
                                            <sup>
                                                <span
                                                    style="display: inline-block; width: 14px; height: 14px; border-radius: 50%; border: 1px solid #777; text-align: center; line-height: 12px; font-size: 10px; cursor: help;"
                                                    data-bs-toggle="tooltip" data-bs-placement="bottom"
                                                    title="Tester le service avec l'exemple Gedcom">?</span>
                                            </sup>
                                    </a>
                                </li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li class="dropdown-header">Export PDF</li>
                                <div id="pdf-export-options">
                                    <li>
                                        <a class="dropdown-item" id="download-pdf-watermark" href="#">
                                            <%= __('geneafan.file_type_list.pdf_watermark') %>
                                                <sup>
                                                    <span
                                                        style="display: inline-block; width: 14px; height: 14px; border-radius: 50%; border: 1px solid #777; text-align: center; line-height: 12px; font-size: 10px; cursor: help;"
                                                        data-bs-toggle="tooltip" data-bs-placement="right"
                                                        title="Téléchargement immédiat du PDF avec filigrane Genealog.ie">?</span>
                                                </sup>
                                        </a>
                                    </li>
                                    <li>
                                        <a class="dropdown-item protected-feature" data-action="downloadPdf"
                                            id="download-pdf" href="#">
                                            <%= __('geneafan.file_type_list.pdf') %>
                                                <sup>
                                                    <span
                                                        style="display: inline-block; width: 14px; height: 14px; border-radius: 50%; border: 1px solid #777; text-align: center; line-height: 12px; font-size: 10px; cursor: help;"
                                                        data-bs-toggle="tooltip" data-bs-placement="right"
                                                        title="Envoi par courriel du PDF imprimable sans filigrane">?</span>
                                                </sup>
                                        </a>
                                    </li>
                                </div>
                                <li>
                                    <a class="dropdown-item" id="download-svg" href="#">
                                        <%= __('geneafan.file_type_list.svg') %>
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" id="download-png-transparency" href="#">
                                        <%= __('geneafan.file_type_list.png_transparent') %>
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" id="download-png-background" href="#">
                                        <%= __('geneafan.file_type_list.png_white_background') %>
                                    </a>
                                </li>
                            </ul>
                        </div>

                        <!-- Tools button -->
                        <div class="me-3">
                            <button class="btn btn-outline-secondary" id="toolsButton" data-bs-toggle="tooltip"
                                data-bs-placement="top" data-bs-trigger="hover" title="Paramètres" disabled>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                    class="bi bi-sliders" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd"
                                        d="M11.5 2a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3M9.05 3a2.5 2.5 0 0 1 4.9 0H16v1h-2.05a2.5 2.5 0 0 1-4.9 0H0V3zM4.5 7a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3M2.05 8a2.5 2.5 0 0 1 4.9 0H16v1H6.95a2.5 2.5 0 0 1-4.9 0H0V8zm9.45 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3m-2.45 1a2.5 2.5 0 0 1 4.9 0H16v1h-2.05a2.5 2.5 0 0 1-4.9 0H0v-1z" />
                                </svg>
                            </button>
                        </div>

                        <!-- Fullscreen button (avec tooltip au survol même désactivé) -->
                        <div class="me-3">
                            <span class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="top"
                                data-bs-trigger="hover" title="<%= __('geneafan.tooltip_full_screen') %>">
                                <button class="btn btn-outline-secondary" id="fullscreenButton" disabled
                                    style="pointer-events: none;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                        class="bi bi-arrows-fullscreen" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd"
                                            d="M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707m4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707m0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707m-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707" />
                                    </svg>
                                </button>
                            </span>
                        </div>

                        <!-- User account (harmonisé avec le style du bouton plein écran) -->
                        <div id="user-controls" class="me-3">
                            <button class="btn btn-outline-secondary" id="sign-in-button" data-bs-toggle="tooltip"
                                data-bs-placement="top" data-bs-trigger="hover" title="Connexion">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                    class="bi bi-person-circle" viewBox="0 0 16 16">
                                    <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0" />
                                    <path fill-rule="evenodd"
                                        d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1" />
                                </svg>
                            </button>
                            <div id="user-button" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <!-- Deuxième ligne: section centrale avec le sélecteur de personne -->
                <div class="selector-container">
                    <div class="selector-wrapper">
                        <button id="undoButton"
                            class="btn btn-dark rounded-circle d-flex align-items-center justify-content-center"
                            style="width: 30px; height: 30px;">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
                                style="width: 14px; height: 14px; fill: currentColor;">
                                <path
                                    d="M386.3 160L336 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l128 0c17.7 0 32-14.3 32-32l0-128c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 51.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0s-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3s163.8-62.5 226.3 0L386.3 160z" />
                            </svg>
                        </button>
                        <div id="individualSelectContainer" style="flex: 1; width: 100%; margin: 0 10px; border-radius: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); background-color: #fff; overflow: hidden;">
                            <input type="text" id="individual-select" class="form-control" 
                                   style="height: 30px; width: 100%; border: none; padding: 0.375rem 1rem; outline: none; background-color: transparent;" 
                                   placeholder="Sélectionner un individu" readonly>
                        </div>
                        <button id="redoButton"
                            class="btn btn-dark rounded-circle d-flex align-items-center justify-content-center"
                            style="width: 30px; height: 30px;">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
                                style="width: 14px; height: 14px; fill: currentColor;">
                                <path
                                    d="M386.3 160L336 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l128 0c17.7 0 32-14.3 32-32l0-128c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 51.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0s-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3s163.8-62.5 226.3 0L386.3 160z" />
                            </svg>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
        <div id="overlay">
            <div id="loading">
                <div class="spinner-border custom-spinner" role="status">
                </div>
                <h2 id="loading-text">
                    <%= __('common.loading_ellipsis') %>
                </h2>
                <em>
                    <%= __('common.please_wait') %>
                </em>
            </div>
        </div>
        <div class="alert alert-primary alert-dismissible fade d-none" id="alert" role="alert">
            <span id="alert-content"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    </header>
    <main>
        <div class="container">
            <!-- Tab content -->
            <div class="tab-content">
                <div class="tab-pane fade show active" id="tab1">
                    <div class="row position-relative" id="fanDisplay">
                        <div id="initial-group">
                            <div>
                                <h5>
                                    <strong>
                                        <%=__('geneafan.privacy')%>
                                    </strong>
                                </h5>
                            </div>
                        </div>
                        <!-- Fan container -->
                        <div id="fanContainer" class="col-12 container-fluid">
                            <svg id="fan"></svg>
                        </div>

                        <!-- Offcanvas for fan settings -->
                        <div class="offcanvas offcanvas-start" tabindex="-1" id="fanParameters"
                            aria-labelledby="fanParametersLabel">
                            <div class="offcanvas-header">
                                <h5 class="offcanvas-title" id="fanParametersLabel">Paramètres de l'éventail</h5>
                                <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"
                                    aria-label="Close"></button>
                            </div>
                            <div class="offcanvas-body" id="fanParametersBody">
                                <div class="container-fluid">
                                    <div class="row col-12 mx-auto">
                                        <!-- Paramètre de l'angle du fan -->
                                        <div class="mb-3 parameter-row">
                                            <label class="form-label">Angle de l'éventail</label>
                                            <div class="btn-group" role="group" aria-label="Angle de l'éventail">
                                                <input type="radio" class="btn-check parameter" name="fanAngle"
                                                    id="fan-angle-270" value="270" checked>
                                                <label class="btn btn-outline-primary" for="fan-angle-270">270°</label>
                                                <input type="radio" class="btn-check parameter" name="fanAngle"
                                                    id="fan-angle-360" value="360">
                                                <label class="btn btn-outline-primary" for="fan-angle-360">360°</label>
                                            </div>
                                        </div>
                                        <!-- Paramètre du nombre de générations -->
                                        <div class="mb-3 parameter-row">
                                            <label class="form-label">Nombre de générations</label>
                                            <div class="btn-group" role="group" aria-label="Nombre de générations">
                                                <input type="radio" class="btn-check parameter" name="max-generations"
                                                    id="max-generations-7" value="7">
                                                <label class="btn btn-outline-primary" for="max-generations-7">7</label>
                                                <input type="radio" class="btn-check parameter" name="max-generations"
                                                    id="max-generations-8" value="8" checked>
                                                <label class="btn btn-outline-primary" for="max-generations-8">8</label>
                                            </div>
                                        </div>
                                        <!-- Paramètre d'affichage des mariages -->
                                        <div class="mb-3 parameter-row">
                                            <label class="form-label">Affichage des mariages</label>
                                            <div class="btn-group" role="group" aria-label="Affichage des mariages">
                                                <input type="radio" class="btn-check parameter" name="showMarriages"
                                                    id="showMarriages-true" value="true" checked>
                                                <label class="btn btn-outline-primary"
                                                    for="showMarriages-true">Oui</label>
                                                <input type="radio" class="btn-check parameter" name="showMarriages"
                                                    id="showMarriages-false" value="false">
                                                <label class="btn btn-outline-primary"
                                                    for="showMarriages-false">Non</label>
                                            </div>
                                        </div>
                                        <!-- Autres paramètres -->
                                        <div class="mb-3 parameter-row">
                                            <label class="form-label">Orientation dynamique du texte</label>
                                            <div class="btn-group" role="group"
                                                aria-label="Orientation dynamique du texte">
                                                <input type="radio" class="btn-check parameter" name="invert-text-arc"
                                                    id="invert-text-arc-true" value="true" checked>
                                                <label class="btn btn-outline-primary"
                                                    for="invert-text-arc-true">Oui</label>
                                                <input type="radio" class="btn-check parameter" name="invert-text-arc"
                                                    id="invert-text-arc-false" value="false">
                                                <label class="btn btn-outline-primary"
                                                    for="invert-text-arc-false">Non</label>
                                            </div>
                                        </div>
                                        <div class="mb-3 parameter-row">
                                            <label class="form-label">Affichage des cases vides</label>
                                            <div class="btn-group" role="group" aria-label="Affichage des cases vides">
                                                <input type="radio" class="btn-check parameter" name="showMissing"
                                                    id="showMissing-true" value="true" checked>
                                                <label class="btn btn-outline-primary"
                                                    for="showMissing-true">Oui</label>
                                                <input type="radio" class="btn-check parameter" name="showMissing"
                                                    id="showMissing-false" value="false">
                                                <label class="btn btn-outline-primary"
                                                    for="showMissing-false">Non</label>
                                            </div>
                                        </div>
                                        <!-- Coloriage de l'éventail -->
                                        <div class="mb-3 parameter-row">
                                            <label class="form-label">Coloriage de l'éventail</label>
                                            <div class="btn-group" role="group" aria-label="Coloriage de l'éventail">
                                                <input type="radio" class="btn-check parameter" name="fanColor"
                                                    id="fan-color-none" value="none" checked>
                                                <label class="btn btn-outline-primary" for="fan-color-none">Non</label>
                                                <input type="radio" class="btn-check parameter" name="fanColor"
                                                    id="fan-color-departement" value="departement">
                                                <label class="btn btn-outline-primary"
                                                    for="fan-color-departement">Géographique</label>
                                                <input type="radio" class="btn-check parameter" name="fanColor"
                                                    id="fan-color-individual" value="individual">
                                                <label class="btn btn-outline-primary"
                                                    for="fan-color-individual">Individuel</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Offcanvas for individuals -->
                        <div class="offcanvas offcanvas-end" tabindex="-1" id="personDetails"
                            aria-labelledby="personDetailsLabel">
                            <div class="offcanvas-header">
                                <h5 id="personDetailsLabel">name</h5>
                                <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"
                                    aria-label="Close"></button>
                            </div>
                            <div id="offCanvasBody" class="text-start" style="overflow-y: auto;">
                                <div id="individualTimeline" class="text-start"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="tab2">
                    <div class="position-relative" style="height: 100%;">
                        <!-- Container de la carte -->
                        <div id="familyMap" style="height: 100%;"></div>
                        <!-- Offcanvas for map settings -->
                        <div class="offcanvas offcanvas-start" tabindex="-1" id="mapParameters" data-bs-backdrop="true"
                            aria-labelledby="mapParametersLabel">
                            <div class="offcanvas-header">
                                <h5 class="offcanvas-title" id="mapParametersLabel">Paramètres de la carte</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="offcanvas"
                                    aria-label="Close"></button>
                            </div>
                            <div class="offcanvas-body" id="mapParametersBody">
                                <div class="container-fluid" id="layerControls">
                                    <!-- Calques -->
                                    <div class="row">
                                        <div class="col-12">
                                            <label class="form-label">Layers</label>
                                            <div class="list-group">
                                                <div class="list-group-item" id="layerAncestorsContainer">
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <label class="form-check-label" for="layerAncestors">Ancestor
                                                            Towns</label>
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox"
                                                                id="layerAncestors">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-group-item" id="layerFamilyContainer">
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <label class="form-check-label" for="layerFamily">Family
                                                            Towns</label>
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox"
                                                                id="layerFamily">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="list-group-item" id="layerSurnamesContainer">
                                                    <!-- Première ligne : Label seul -->
                                                    <div class="mb-2">
                                                        Towns by Surnames
                                                    </div>
                                                    <!-- Deuxième ligne : Select et Switch -->
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <select class="form-select form-select-sm me-2"
                                                            id="surnameFilter" disabled style="width: auto;">
                                                            <option value="">Select a surname...</option>
                                                        </select>
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox"
                                                                id="layerSurnames">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Bouton avec z-index très élevé 
                                    <button class="btn btn-light position-absolute top-0 end-0 m-2" type="button"
                                        data-bs-toggle="offcanvas" data-bs-target="#placesListOffcanvas"
                                        style="z-index: 1000002;">
                                        <i class="bi bi-list-ul"></i> Liste des lieux
                                    </button>
                                    -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="tab3">
                    <div class="row position-relative" id="treeDisplay"></div>
                    <!-- Tree container -->
                    <div class="col-12 container-fluid align-items-center mt-2" id="treeContainer"
                        style="height: 95vh;"></div>
                    <!-- Offcanvas for tree settings -->
                    <div class="offcanvas offcanvas-start" tabindex="-1" id="treeParameters"
                        aria-labelledby="treeParametersLabel">
                        <div class="offcanvas-header">
                            <h5 class="offcanvas-title" id="treeParametersLabel">Paramètres de l'arbre</h5>
                            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"
                                aria-label="Close"></button>
                        </div>
                        <div class="offcanvas-body">
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-12 mx-auto" id="treeParametersDisplay">
                                        <div class="mb-3 parameter-row">
                                            <label for="commonAncestor" class="form-label">Recherche</label>
                                            <div class="btn-group" role="group">
                                                <button type="button" id="commonAncestor"
                                                    class="btn btn-primary">Ancêtre commun</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="tab4">
                    <div class="horizontal-timeline" id="ascendantTimeline"></div>
                </div>
                <!-- Container for the Statistics tab -->
                <div class="tab-pane fade statistics-container" id="tab5" role="tabpanel">
                    <!-- Sticky Overview Section -->
                    <div class="sticky-overview">
                        <div class="container-fluid">
                            <!-- Quick Navigation -->
                            <div class="row mb-3">
                                <div class="col-12">
                                    <nav class="nav nav-pills nav-fill small">
                                        <a class="nav-link" href="#demography-section">Démographie</a>
                                        <a class="nav-link" href="#geography-section">Géographie</a>
                                        <a class="nav-link" href="#family-section">Relations Familiales</a>
                                        <a class="nav-link" href="#timeline-section">Chronologie</a>
                                    </nav>
                                </div>
                            </div>
                            <!-- Overview Cards -->
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h6 class="card-title text-muted mb-0">Nombre total d'individus</h6>
                                            <h2 class="display-6 fw-bold mb-0" id="total-individuals">-</h2>
                                            <small class="text-muted">personnes recensées</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h6 class="card-title text-muted mb-0">Nombre de mariages</h6>
                                            <h2 class="display-6 fw-bold mb-0" id="total-marriages">-</h2>
                                            <small class="text-muted">unions enregistrées</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h6 class="card-title text-muted mb-0">Moyenne d'enfants</h6>
                                            <h2 class="display-6 fw-bold mb-0" id="avg-children">-</h2>
                                            <small class="text-muted">par couple marié</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <h6 class="card-title text-muted mb-0">Espérance de vie</h6>
                                            <h2 class="display-6 fw-bold mb-0" id="avg-lifespan">-</h2>
                                            <small class="text-muted">moyenne globale</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Scrollable Content -->
                    <div class="statistics-content">
                        <div class="container-fluid">
                            <!-- Demography Section -->
                            <div class="row mb-5" id="demography-section">
                                <div class="col-12">
                                    <h4 class="section-title">
                                        <i class="bi bi-people-fill me-2"></i>
                                        Démographie
                                    </h4>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="card-title mb-0">Distribution des âges au décès</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="age-chart" class="chart-container"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="card-title mb-0">Évolution de l'espérance de vie</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="lifespan-chart" class="chart-container"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Geography Section -->
                            <div class="row mb-5" id="geography-section">
                                <div class="col-12">
                                    <h4 class="section-title">
                                        <i class="bi bi-geo-alt-fill me-2"></i>
                                        Géographie
                                    </h4>
                                </div>
                                <div class="col-12">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="card-title mb-0">Distribution géographique des naissances et
                                                migrations</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="birth-death-places-chart" class="chart-container"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Family Relations Section -->
                            <div class="row mb-5" id="family-section">
                                <div class="col-12">
                                    <h4 class="section-title">
                                        <i class="bi bi-diagram-3-fill me-2"></i>
                                        Relations Familiales
                                    </h4>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="card-title mb-0">Distribution des mariages par décennie</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="marriages-timeline-chart" class="chart-container"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="card-title mb-0">Taille des familles</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="family-size-chart" class="chart-container"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Timeline Section -->
                            <div class="row mb-5" id="timeline-section">
                                <div class="col-12">
                                    <h4 class="section-title">
                                        <i class="bi bi-calendar-event-fill me-2"></i>
                                        Chronologie
                                    </h4>
                                </div>
                                <div class="col-12">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="card-title mb-0">Distribution temporelle des événements</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="events-timeline-chart" class="chart-container"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Modals -->
                <div class="modal fade" id="emailModal" tabindex="-1" role="dialog" aria-labelledby="emailModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="emailModalLabel">Saisissez l'adresse à laquelle vous
                                    souhaitez recevoir le PDF de l'éventail sans filigrane.</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <input type="email" class="form-control" id="userEmailInput"
                                    placeholder="Votre adresse de courriel">
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" id="email">Valider</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal fade" id="confirmationModal" tabindex="-1" role="dialog"
                    aria-labelledby="confirmationModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="confirmationModalLabel">Confirmation</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                Le fichier PDF de votre éventail sera envoyé dans quelques minutes à l'adresse indiquée.
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal de Connexion -->
                <div class="modal fade" id="signInModal" tabindex="-1" aria-labelledby="signInModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="signInModalLabel">Se Connecter</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Fermer"></button>
                            </div>
                            <div class="modal-body">
                                <div id="sign-in"></div> <!-- Conteneur pour le formulaire de connexion -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Élément pour le contenu dynamique (formulaire de connexion, commutateur d'organisations, etc.) -->

                <!-- Offcanvas Places List -->
                <div class="offcanvas offcanvas-end" tabindex="-1" id="placesListOffcanvas">
                    <div class="offcanvas-header">
                        <h5 class="offcanvas-title">Liste des lieux</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
                    </div>
                    <div class="offcanvas-body">
                        <!-- Recherche -->
                        <div class="mb-3">
                            <input type="text" class="form-control" id="searchPlace"
                                placeholder="Rechercher un lieu...">
                        </div>

                        <!-- Filtre département -->
                        <div class="mb-3">
                            <select class="form-select" id="departementFilter">
                                <option value="">Tous les départements</option>
                            </select>
                        </div>

                        <!-- Liste des lieux -->
                        <div class="list-group" id="placesList"></div>

                        <!-- Compteur -->
                        <div class="mt-3 text-muted small" id="placesCounter"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <!-- Scripts -->
    <script>
        var isReady = true;
        window.onerror = function errorHandler(msg, url, line) {
            isReady = false;
            var e = document.getElementById('loading');
            e.innerHTML = "<h2><i class=\"fas fa-exclamation-triangle\" aria-hidden=\"true\"></i> ${__('geneafan.an_error_occurred')}</h2>${__('geneafan.your_browser_is_incompatible')}";
            return false;
        };
    </script>

</body>

</html>